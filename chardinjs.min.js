function ChardinJs(e){var t=this;this.$el=e;this.isOpened=false;window.onresize=function(e){return t.refresh()};return this}ChardinJs.prototype.utils={classy:{hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){if(!this.hasClass(e,t))e.className+=" "+t},removeClass:function(e,t){if(this.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}},removeElementsByClass:function(e){var t=document.getElementsByClassName(e);while(t.length>0){t[0].parentNode.removeChild(t[0])}},removeClassesByClass:function(e,t){var n=document.getElementsByClassName(e);while(n.length>0){this.classy.removeClass(n[0],t)}}};ChardinJs.prototype.start=function(){var e,t,n,r;if(this._overlay_visible()){return false}this._add_overlay_layer();r=this.$el.querySelectorAll("[data-intro]");for(t=0,n=r.length;t<n;t++){e=r[t];this._show_element(e)}};ChardinJs.prototype.toggle=function(){if(!this._overlay_visible()){return this.start()}else{return this.stop()}};ChardinJs.prototype.refresh=function(){var e,t,n,r,i;if(this._overlay_visible()){r=this.$el.querySelectorAll("[data-intro]");i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(this._position_helper_layer(e))}return i}else{return this}};ChardinJs.prototype.stop=function(){this.utils.removeElementsByClass("chardinjs-overlay");this.utils.removeElementsByClass("chardinjs-helper-layer");this.utils.removeClassesByClass("chardinjs-show-element","chardinjs-show-element");this.utils.removeClassesByClass("chardinjs-relative-position","chardinjs-relative-position");if(window.removeEventListener){window.removeEventListener("keydown",this._onKeyDown,true)}else{if(document.detachEvent){document.detachEvent("onkeydown",this._onKeyDown)}}};ChardinJs.prototype._overlay_visible=function(){return this.$el.getElementsByClassName("chardinjs-overlay").length!==0};ChardinJs.prototype._add_overlay_layer=function(){var e,t,n,r=this;if(this._overlay_visible()){return false}t=document.createElement("div");n="";t.className="chardinjs-overlay";if(this.$el.nodeName.toUpperCase()==="BODY"){n+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;";t.setAttribute("style",n)}else{e=this._get_offset(this.$el);if(e){n+="width: "+e.width+"px; height:"+e.height+"px; top:"+e.top+"px;left: "+e.left+"px;";t.setAttribute("style",n)}}this.$el.appendChild(t);t.onclick=function(){return r.stop()};return setTimeout(function(){n+="opacity: .8;opacity: .8;-ms-filter: 'progid:DXImageTransform.Microsoft.Alpha(Opacity=80)';filter: alpha(opacity=80);";return t.setAttribute("style",n)},10)};ChardinJs.prototype._get_position=function(e){return e.getAttribute("data-position")||"bottom"};ChardinJs.prototype._place_tooltip=function(e){var t,n,r,i,s,o,u;o=document.getElementById(e.dataset.tooltipLayer);u=this._get_offset(o);o.style.top=null;o.style.right=null;o.style.bottom=null;o.style.left=null;switch(this._get_position(e)){case"top":case"bottom":r=this._get_offset(e);s=r.width;n=o.offsetWidth;o.style.left=""+(s/2-u.width/2)+"px";break;case"left":case"right":r=this._get_offset(e);i=r.height;t=o.offsetHeight;o.style.top=""+(i/2-u.height/2)+"px"}switch(this._get_position(e)){case"left":return o.style.left="-"+(u.width-34)+"px";case"right":return o.style.right="-"+(u.width-34)+"px";case"bottom":return o.style.bottom="-"+u.height+"px";case"top":return o.style.top="-"+u.height+"px"}};ChardinJs.prototype._position_helper_layer=function(e){var t,n;n=document.getElementById(e.dataset.helperLayer);t=this._get_offset(e);return n.setAttribute("style","width: "+t.width+"px; height:"+t.height+"px; top:"+t.top+"px; left: "+t.left+"px;")};ChardinJs.prototype._show_element=function(e){var t,n,r,i;n=this._get_offset(e);r=document.createElement("div");r.id="helper_"+(new Date).getTime();i=document.createElement("div");i.id="tooltip_"+(new Date).getTime();e.dataset.helperLayer=r.id;e.dataset.tooltipLayer=i.id;if(e.id){r.setAttribute("data-id",e.id)}r.className="chardinjs-helper-layer chardinjs-"+this._get_position(e);this.$el.appendChild(r);this._position_helper_layer(e);i.className="chardinjs-tooltip chardinjs-"+this._get_position(e);i.innerHTML="<div class='chardinjs-tooltiptext'>"+e.getAttribute("data-intro")+"</div>";r.appendChild(i);this._place_tooltip(e);e.className+=" chardinjs-show-element";t="";if(e.currentStyle){t=e.currentStyle["position"]}else{if(document.defaultView&&document.defaultView.getComputedStyle){t=document.defaultView.getComputedStyle(e,null).getPropertyValue("position")}}t=t.toLowerCase();if(t!=="absolute"&&t!=="relative"){return e.className+=" chardinjs-relative-position"}};ChardinJs.prototype._get_offset=function(e){var t,n,r;t={width:e.offsetWidth,height:e.offsetHeight};n=0;r=0;while(e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop)){n+=e.offsetLeft;r+=e.offsetTop;e=e.offsetParent}t.top=r;t.left=n;return t}